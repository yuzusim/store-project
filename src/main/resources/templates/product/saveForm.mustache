{{> layout/header}}
<div class="container">
    <form action="/product/add" method="post" onsubmit="return valid()">
        <div class="d-flex mb-3 mt-3">
            <div class="">
                상품명 : <input id="name" name="name" type="text"
                             placeholder="상품명을 적어주세요">
            </div>
            <div>
                <button type="button" onclick="nameSameCheck()" class="btn btn-warning">상품중복체크</button>
            </div>
        </div>

        <div class="mb-3 mt-3">
            상품가격 : <input name="price" type="number"
                          placeholder="상품 가격을 적어주세요">
        </div>
        <div class="mb-3 mt-3">
            상품수량 : <input name="qty" type="number" placeholder="상품 수량을 적어주세요">
        </div>
        <button type="submit" class="btn btn-primary">상품등록완료</button>
    </form>


</div>

<script>
    let isSameCheck = false;

    function valid() {
        if (isSameCheck == false) {
            alert("상품 중복체크를 해야 합니다");
        }
        return isSameCheck;
    }

    function nameSameCheck() {
        let name = $("#name").val();

        $.ajax({
            url: "/api/name-same-check?name=" + name,
            type: "get"
            // 여기에서 요청을 하면 되요.
        }).done((res) => {
            console.log(res);
            if (res.body == true) {
                isSameCheck = true;
                alert("상품 중복 체크 완료");
            } else {
                isSameCheck = false;
                alert("동일한 상품이 존재합니다");
            }

        }).fail((res) => {
            alert(res.responseJSON.msg);
        });
    }
</script>
{{> layout/footer}}